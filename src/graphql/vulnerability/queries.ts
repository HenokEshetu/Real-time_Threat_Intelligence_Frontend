import { gql } from '@apollo/client';

export const GET_VULNERABILITY = gql`
  query GetVulnerability($id: String!) {
    vulnerability(id: $id) {
      id
      name
      description
      affected_products
      confidence
      created
      created_by_ref
      cve_id
      cvss_v3_score
      cvss_v3_vector
      enrichment
      extensions
      external_references {
        source_name
        url
        external_id
      }
      labels
      lang
      last_modified_date
      modified
      object_marking_refs
      published_date
      references
      relationship {
        relationship_type
        source_ref
        target_ref
      }
      revoked
      spec_version
      type
      vulnerability_status
    }
  }
`;

export const GET_VULNERABILITY_BY_CVE = gql`
  query GetVulnerabilityByCveId($cveId: String!) {
    vulnerabilityByCveId(cveId: $cveId) {
      id
      name
      description
      affected_products
      confidence
      created
      created_by_ref
      cve_id
      cvss_v3_score
      cvss_v3_vector
      enrichment
      extensions
      external_references {
        source_name
        url
        external_id
      }
      labels
      lang
      last_modified_date
      modified
      object_marking_refs
      published_date
      references
      relationship {
        relationship_type
        source_ref
        target_ref
      }
      revoked
      spec_version
      type
      vulnerability_status
    }
  }
`;

export const SEARCH_VULNERABILITIES = gql`
  query SearchVulnerabilities(
    $filters: SearchVulnerabilityInput
    $page: Int = 1
    $pageSize: Int = 10
    $sortField: String = "modified"
    $sortOrder: String = "desc"
  ) {
    searchVulnerabilities(
      filters: $filters
      page: $page
      pageSize: $pageSize
      sortField: $sortField
      sortOrder: $sortOrder
    ) {
      page
      pageSize
      total
      totalPages
      results {
        id
        name
        description
        affected_products
        confidence
        created
        created_by_ref
        cve_id
        cvss_v3_score
        cvss_v3_vector
        enrichment
        extensions
        external_references {
          source_name
          url
          external_id
        }
        labels
        lang
        last_modified_date
        modified
        object_marking_refs
        published_date
        references
        relationship {
          relationship_type
          source_ref
          target_ref
        }
        revoked
        spec_version
        type
        vulnerability_status
      }
    }
  }
`;
