import { gql } from '@apollo/client';

export const CREATE_VULNERABILITY = gql`
  mutation CreateVulnerability($input: CreateVulnerabilityInput!) {
    createVulnerability(input: $input) {
      id
      name
      description
      affected_products
      confidence
      created
      created_by_ref
      cve_id
      cvss_v3_score
      cvss_v3_vector
      enrichment
      extensions
      external_references {
        source_name
        url
        external_id
      }
      labels
      lang
      last_modified_date
      modified
      object_marking_refs
      published_date
      references
      relationship {
        relationship_type
        source_ref
        target_ref
      }
      revoked
      spec_version
      type
      vulnerability_status
    }
  }
`;

export const UPDATE_VULNERABILITY = gql`
  mutation UpdateVulnerability($id: String!, $input: UpdateVulnerabilityInput!) {
    updateVulnerability(id: $id, input: $input) {
      id
      name
      description
      affected_products
      confidence
      created
      created_by_ref
      cve_id
      cvss_v3_score
      cvss_v3_vector
      enrichment
      extensions
      external_references {
        source_name
        url
        external_id
      }
      labels
      lang
      last_modified_date
      modified
      object_marking_refs
      published_date
      references
      relationship {
        relationship_type
        source_ref
        target_ref
      }
      revoked
      spec_version
      type
      vulnerability_status
    }
  }
`;

export const DELETE_VULNERABILITY = gql`
  mutation DeleteVulnerability($id: String!) {
    deleteVulnerability(id: $id)
  }
`;
