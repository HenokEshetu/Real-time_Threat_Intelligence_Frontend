import { Field, ObjectType } from '@nestjs/graphql';
import { CommonProperties, RelationshipCommonProperties } from '../../../../core/types/common-data-types';


@ObjectType()
export class MalwareAnalysis extends CommonProperties {
  @Field(() => String)
  type: string = 'malware-analysis';

  @Field(() => String)
  product: string;

  @Field(() => String, { nullable: true })
  version?: string;

  @Field(() => [String])
  host_vm_ref: string[];

  @Field(() => [String])
  operating_system_ref: string[];

  @Field(() => [String])
  installed_software_ref: string[];

  @Field(() => [String])
  configuration_version: string[];

  @Field(() => [String], { nullable: true })
  modules?: string[];

  @Field(() => String, { nullable: true })
  analysis_engine_version?: string;

  @Field(() => String, { nullable: true })
  analysis_definition_version?: string;

  @Field(() => Date)
  submitted: Date;

  @Field(() => Date, { nullable: true })
  analysis_started?: Date;

  @Field(() => Date, { nullable: true })
  analysis_ended?: Date;

  @Field(() => String)
  result: string;

  @Field(() => [String], { nullable: true })
  analysis_sco_refs?: string[];

  @Field(() => [String], { nullable: true })
  sample_ref?: string[];

  @Field(() => [RelationshipCommonProperties], { nullable: true })
    relationship?: RelationshipCommonProperties[];
}